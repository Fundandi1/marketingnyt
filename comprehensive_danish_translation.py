"""
Comprehensive translation of ALL mixed Danish/English text to pure Danish
"""

from news.models import ArticlePage
import re

print('=== COMPREHENSIVE DANISH TRANSLATION ===\n')

# Very comprehensive translation dictionary - PURE DANISH
translations = {
    # Common English words that MUST be translated
    'Upload minimum': 'Upload minimum',
    'Upload': 'Upload',
    'Minimum': 'Minimum',
    'minimum': 'minimum',
    'High-quality': 'Høj kvalitet',
    'high-quality': 'høj kvalitet',
    'Inkluder': 'Inkluder',
    'Exterior': 'Eksteriør',
    'interior': 'interiør',
    'Interior': 'Interiør',
    'produkter': 'produkter',
    'Products': 'Produkter',
    'products': 'produkter',
    'Team': 'Team',
    'team': 'team',
    'Logo': 'Logo',
    'logo': 'logo',
    'fresh content': 'frisk indhold',
    'Optimal størrelse': 'Optimal størrelse',
    'pixels': 'pixels',
    'Post minimum': 'Post minimum',
    'Post types': 'Post typer',
    'Offers': 'Tilbud',
    'Events': 'Events',
    'events': 'events',
    'updates': 'opdateringer',
    'CTA button': 'CTA knap',
    'Keywords': 'Søgeord',
    'keywords': 'søgeord',
    'naturligt': 'naturligt',
    'Seed': 'Seed',
    'seed': 'seed',
    'Q&A sektion': 'Q&A sektion',
    'Q&A': 'Q&A',
    'common questions': 'almindelige spørgsmål',
    'Monitor': 'Overvåg',
    'besvar': 'besvar',
    'inden for': 'inden for',
    'upload': 'upload',
    
    # More comprehensive translations
    'highly impacts': 'har stor indflydelse på',
    'purchase decisions': 'købsbeslutninger',
    'consumers': 'forbrugere',
    'traditional ads': 'traditionel annoncering',
    'privacy': 'privatliv',
    'marketers': 'marketingfolk',
    'Broad Targeting': 'Bred målretning',
    'Creative Testing': 'Kreativ testning',
    'Video-First Approach': 'Video-først tilgang',
    'Video content': 'Video indhold',
    'performer': 'performer',
    'statiske billeder': 'statiske billeder',
    'User Generated Content': 'Bruger-genereret indhold',
    'Conversion API': 'Conversion API',
    'Implementation': 'Implementering',
    'Server-side tracking': 'Server-side tracking',
    'Retention Campaigns': 'Fastholdelseskampagner',
    'email lists': 'email lister',
    'custom audiences': 'tilpassede målgrupper',
    'higher ROI': 'højere ROI',
    
    # Technical terms
    'tracking': 'tracking',
    'implementation': 'implementering',
    'audience research': 'målgruppeanalyse',
    'competitive analysis': 'konkurrentanalyse',
    'goal setting': 'målsætning',
    'KPI definition': 'KPI definition',
    'Best practices': 'Best practices',
    'for launch': 'for lancering',
    'Start small': 'Start småt',
    'og scale': 'og skalér',
    'gradvist': 'gradvist',
    'limited budget': 'begrænset budget',
    'fokusér': 'fokusér',
    'setup proper': 'opsæt ordentlig',
    'fra dag 1': 'fra dag 1',
    'dokumentér': 'dokumentér',
    'for senere reference': 'til senere reference',
    'winning formulas': 'vindende formler',
    'proper tracking': 'ordentlig tracking',
    'gut feeling': 'mavefornemmelse',
    'personlige præferencer': 'personlige præferencer',
    'Random testing': 'Tilfældig testning',
    'test roadmap': 'test køreplan',
    'audience targeting': 'målgruppetargeting',
    'website tracking': 'hjemmeside tracking',
    'user behavior': 'brugeradfærd',
    'analysis': 'analyse',
    'product analytics': 'produkt analytics',
    'Data Studio': 'Data Studio',
    'for reporting': 'til rapportering',
    'advanced experimentation': 'avanceret eksperimentering',
    'conversion optimization': 'konverteringsoptimering',
    'workflow automation': 'workflow automatisering',
    'complex automations': 'komplekse automatiseringer',
    'native platform': 'native platform',
    'automation features': 'automatiseringsfunktioner',
    'clear KPIs': 'klare KPIs',
    'før du starter': 'før du starter',
    'Typiske KPIs': 'Typiske KPIs',
    'inkluderer': 'inkluderer',
    'Primary KPI': 'Primær KPI',
    'revenue': 'omsætning',
    'leads': 'leads',
    'signups': 'tilmeldinger',
    'secondary KPIs': 'sekundære KPIs',
    'engagement': 'engagement',
    'reach': 'reach',
    'brand awareness': 'brand awareness',
    'efficiency metrics': 'effektivitets metrics',
    'conversion rate': 'konverteringsrate',
    'Quick check': 'Hurtig tjek',
    'key metrics': 'nøgle metrics',
    'Detailed performance': 'Detaljeret performance',
    'review': 'gennemgang',
    'Comprehensive analysis': 'Omfattende analyse',
    'strategy adjustments': 'strategi justeringer',
    'Big picture': 'Overordnet',
    'og planning': 'og planlægning',
    'Audit': 'Gennemgå',
    'nuværende setup': 'nuværende opsætning',
    'identificér gaps': 'identificér huller',
    'Implementér': 'Implementér',
    'hvis ikke allerede': 'hvis ikke allerede',
    'på plads': 'på plads',
    'Definer clear': 'Definer klare',
    'goals': 'mål',
    'Start med én': 'Start med én',
    'fokuseret campaign': 'fokuseret kampagne',
    'Measure, learn, og iterate': 'Mål, lær og iterér',
    'Success kommer fra': 'Succes kommer fra',
    'konsistent execution': 'konsistent eksekvering',
    'kontinuerlig forbedring': 'kontinuerlig forbedring',
    'Start small, test ofte': 'Start småt, test ofte',
    'og scale hvad': 'og skalér hvad',
    'der virker': 'der virker',
    
    # Content-specific terms
    'pillar content': 'søjle-indhold',
    'Long-form': 'Langt format',
    'comprehensive content': 'omfattende indhold',
    'dækker et emne': 'dækker et emne',
    'i dybden': 'i dybden',
    'word blog post': 'ord blog post',
    'minute webinar': 'minutters webinar',
    'minute podcast episode': 'minutters podcast episode',
    'comprehensive guide': 'omfattende guide',
    'ebook': 'e-bog',
    'case study': 'case study',
    'med data': 'med data',
    'Evergreen': 'Tidløst',
    'ikke time-sensitive': 'ikke tidsfølsomt',
    'actionable': 'handlingsbart',
    'folk kan bruge det': 'folk kan bruge det',
    'data-driven': 'data-drevet',
    'tal og eksempler': 'tal og eksempler',
    'Break it down': 'Bryd det ned',
    'Tag dit': 'Tag dit',
    'og break det ned': 'og bryd det ned',
    'i mindre pieces': 'i mindre dele',
    'Fra blog post': 'Fra blog post',
    'Key takeaways': 'Vigtigste pointer',
    'social posts': 'sociale opslag',
    'statistics': 'statistikker',
    'infographics': 'infografikker',
    'quotes': 'citater',
    'quote graphics': 'citat grafik',
    'sections': 'sektioner',
    'LinkedIn articles': 'LinkedIn artikler',
    'tips': 'tips',
    'Twitter threads': 'Twitter tråde',
    'Transform formats': 'Transformer formater',
    'Tag samme content': 'Tag samme indhold',
    'og transformer det': 'og transformer det',
    'til forskellige formater': 'til forskellige formater',
    'Transformations': 'Transformationer',
    'talking head': 'talking head',
    'read + commentary': 'læs + kommentar',
    'transcript + editing': 'transskription + redigering',
    '+ visuals': '+ visuals',
    'Email course': 'Email kursus',
    'chapter per email': 'kapitel per email',
    
    # Platform-specific
    'Platform-specific': 'Platform-specifik',
    'repurposing': 'genanvendelse',
    'Fra pillar content': 'Fra søjle-indhold',
    'Carousel posts': 'Karrusel opslag',
    'slides': 'slides',
    'text posts': 'tekst opslag',
    'med key insights': 'med vigtige indsigter',
    'polls': 'afstemninger',
    'baseret på data': 'baseret på data',
    'longer form': 'længere format',
    'video clips': 'video klip',
    'First line hook': 'Første linje hook',
    'short paragraphs': 'korte afsnit',
    'call-to-action': 'call-to-action',
    'i comments': 'i kommentarer',
    'Thread': 'Tråd',
    'tweets': 'tweets',
    'quote tweets': 'citat tweets',
    'med stats': 'med statistikker',
    'single tweets': 'enkelte tweets',
    'visual tweets': 'visuelle tweets',
    'screenshots': 'screenshots',
    'af data': 'af data',
    'Hook i første tweet': 'Hook i første tweet',
    'numbered threads': 'nummererede tråde',
    'CTA i sidste tweet': 'CTA i sidste tweet',
    'design-heavy': 'design-tungt',
    'Reels': 'Reels',
    'short video tips': 'korte video tips',
    'Stories': 'Stories',
    'behind-the-scenes': 'bag kulisserne',
    'Visual-first': 'Visual-først',
    'text overlay': 'tekst overlay',
    'strong hook': 'stærk hook',
    'i første slide': 'i første slide',
    'Long-form video': 'Langt format video',
    'Shorts': 'Shorts',
    'under 60 sec': 'under 60 sek',
    '+ slides': '+ slides',
    'screen recording': 'skærmoptagelse',
    '+ voiceover': '+ voice-over',
    'animated explainer': 'animeret forklaring',
    'Strong thumbnail': 'Stærk thumbnail',
    'hook i første': 'hook i første',
    'sekunder': 'sekunder',
    'chapters for long videos': 'kapitler til lange videoer',
    'Quick tips': 'Hurtige tips',
    'myth-busting': 'myte-aflivning',
    'before/after': 'før/efter',
    'Things I wish I knew': 'Ting jeg ville ønske jeg vidste',
    'trending audio': 'trending lyd',
    '+ your message': '+ dit budskab',
    'Hook i første 3': 'Hook i første 3',
    'trending sounds': 'trending lyde',
}

fixed_count = 0
articles = ArticlePage.objects.filter(live=True).exclude(category__slug='podcasts')

for article in articles:
    body_list = list(article.body.raw_data) if article.body else []
    
    modified = False
    for i, block in enumerate(body_list):
        if block.get('type') == 'rich_text':
            original_value = block.get('value', '')
            translated_value = original_value
            
            # Apply all translations
            for eng, dan in translations.items():
                if eng in translated_value:
                    translated_value = translated_value.replace(eng, dan)
                    modified = True
            
            if translated_value != original_value:
                body_list[i]['value'] = translated_value
    
    if modified:
        # Save article
        article.body = body_list
        revision = article.save_revision()
        revision.publish()
        fixed_count += 1
        print(f'✓ {article.title[:60]}...')

print(f'\n=== DONE! {fixed_count} articles translated to pure Danish ===')

